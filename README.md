### æ ¡å¯¹âœ… [![translate-svg]][translate-list]

[translate-svg]: http://llever.com/translate.svg
[translate-list]: https://github.com/chinanf-boy/chinese-translate-list


æ¬¢è¿ `Issue` å’Œ `Pull` â¤ï¸, æœ€å¥½ `Pull` ğŸ‘ 

- â° 2018 7.25 å¼€å§‹/ç»“æŸ

## ç”Ÿæ´»

[help me live , live need money ğŸ’°](https://github.com/chinanf-boy/live-need-money)

<details>

<summary> ç›®å½• </summary>

<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->


- [TypeScript React Starter](#typescript-react-starter)
- [å®‰è£…create-react-app](#%E5%AE%89%E8%A3%85create-react-app)
- [åˆ›å»ºæˆ‘ä»¬çš„æ–°é¡¹ç›®](#%E5%88%9B%E5%BB%BA%E6%88%91%E4%BB%AC%E7%9A%84%E6%96%B0%E9%A1%B9%E7%9B%AE)
- [è¿è¡Œé¡¹ç›®](#%E8%BF%90%E8%A1%8C%E9%A1%B9%E7%9B%AE)
- [æµ‹è¯•é¡¹ç›®](#%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE)
- [åˆ›å»ºç”Ÿäº§æ„å»º](#%E5%88%9B%E5%BB%BA%E7%94%9F%E4%BA%A7%E6%9E%84%E5%BB%BA)
- [åˆ›å»ºç»„ä»¶](#%E5%88%9B%E5%BB%BA%E7%BB%84%E4%BB%B6)
  - [ç±»å‹æ–­è¨€](#%E7%B1%BB%E5%9E%8B%E6%96%AD%E8%A8%80)
- [æ·»åŠ style ğŸ˜](#%E6%B7%BB%E5%8A%A0style-)
- [ç”¨Jestå†™æµ‹è¯•](#%E7%94%A8jest%E5%86%99%E6%B5%8B%E8%AF%95)
- [æ·»åŠ çŠ¶æ€ç®¡ç†](#%E6%B7%BB%E5%8A%A0%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86)
  - [é€šç”¨çŠ¶æ€ç®¡ç†](#%E9%80%9A%E7%94%A8%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86)
  - [ä¸º actions è®¾å®šé˜¶æ®µ](#%E4%B8%BA-actions-%E8%AE%BE%E5%AE%9A%E9%98%B6%E6%AE%B5)
  - [å®‰è£…Redux](#%E5%AE%89%E8%A3%85redux)
  - [ç®€å•è¯´æ˜ Redux æµç¨‹](#%E7%AE%80%E5%8D%95%E8%AF%B4%E6%98%8E-redux-%E6%B5%81%E7%A8%8B)
    - [Redux æœ¬èº«éœ€è¦è®¾ç½®çš„](#redux-%E6%9C%AC%E8%BA%AB%E9%9C%80%E8%A6%81%E8%AE%BE%E7%BD%AE%E7%9A%84)
    - [è®¾ç½®å¥½Reduxå,ä¸ç»„ä»¶æ··åˆæˆä¸ºå®¹å™¨](#%E8%AE%BE%E7%BD%AE%E5%A5%BDredux%E5%90%8E%E4%B8%8E%E7%BB%84%E4%BB%B6%E6%B7%B7%E5%90%88%E6%88%90%E4%B8%BA%E5%AE%B9%E5%99%A8)
  - [å®šä¹‰æˆ‘ä»¬åº”ç”¨ç¨‹åºçš„çŠ¶æ€](#%E5%AE%9A%E4%B9%89%E6%88%91%E4%BB%AC%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%9A%84%E7%8A%B6%E6%80%81)
  - [æ·»åŠ action](#%E6%B7%BB%E5%8A%A0action)
  - [æ·»åŠ  å‡é€Ÿæœº-reducer](#%E6%B7%BB%E5%8A%A0-%E5%87%8F%E9%80%9F%E6%9C%BA-reducer)
  - [åˆ¶ä½œä¸€ä¸ªå®¹å™¨](#%E5%88%B6%E4%BD%9C%E4%B8%80%E4%B8%AA%E5%AE%B9%E5%99%A8)
  - [åˆ›å»ºå­˜å‚¨](#%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8)
- [å¼¹å‡º-Ejecting](#%E5%BC%B9%E5%87%BA-ejecting)
- [ä¸‹ä¸€æ­¥](#%E4%B8%8B%E4%B8%80%E6%AD%A5)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

</details>

# TypeScript React Starter

æœ¬å¿«é€Ÿå…¥é—¨æŒ‡å—å°†æ•™æ‚¨å¦‚ä½•è¿æ¥TypeScriptä¸[React](http://facebook.github.io/react/). åˆ°æœ€å,ä½ ä¼šæœ‰

-   ä¸€ä¸ªä½¿ç”¨ Reactå’ŒTypeScript çš„é¡¹ç›®
-   [TSLint](https://github.com/palantir/tslint)ä»£ç è§„èŒƒ
-   ç”¨[Jest](https://facebook.github.io/jest/)å’Œ[Enzyme](http://airbnb.io/enzyme/)æµ‹è¯•,å’Œ
-   çŠ¶æ€ç®¡ç†[Redux](https://github.com/reactjs/react-redux)

æˆ‘ä»¬å°†ä½¿ç”¨[create-react-app](https://github.com/facebookincubator/create-react-app)å·¥å…·å»å¿«é€Ÿè®¾ç½®. 

æˆ‘ä»¬å‡è®¾æ‚¨å·²ç»åœ¨ä½¿ç”¨[Node.js](https://nodejs.org/)åŒ[npm](https://www.npmjs.com/). æ‚¨å¯èƒ½è¿˜æƒ³äº†è§£ä¸€ä¸‹[React åŸºç¡€](https://facebook.github.io/react/docs/hello-world.html). 

# å®‰è£…create-react-app

æˆ‘ä»¬å°†ä½¿ç”¨create-react-app,å› ä¸ºå®ƒä¸º Reacté¡¹ç›®è®¾ç½®äº† ä¸€äº›æœ‰ç”¨çš„å·¥å…·å’Œè§„èŒƒé»˜è®¤å€¼. è¿™åªæ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå®ç”¨ç¨‹åºæ¥æ„å»º æ–°çš„Reacté¡¹ç›®. 

```shell
npm install -g create-react-app
```

# åˆ›å»ºæˆ‘ä»¬çš„æ–°é¡¹ç›®

æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªåä¸ºçš„æ–°é¡¹ç›®`my-app`: 

```shell
create-react-app my-app --scripts-version=react-scripts-ts
```

[react-scripts-ts](https://www.npmjs.com/package/react-scripts-ts)æ˜¯ä¸€ç»„è°ƒæ•´,ä»¥é‡‡ç”¨ æ ‡å‡†çš„create-react-appé¡¹ç›®ç®¡é“ å¹¶å°† TypeScript å¼•å…¥æ··åˆ. 

æ­¤æ—¶,æ‚¨çš„é¡¹ç›®å¸ƒå±€åº”å¦‚ä¸‹æ‰€ç¤º: 

```text
my-app/
â”œâ”€ .gitignore
â”œâ”€ node_modules/
â”œâ”€ public/
â”œâ”€ src/
â”‚  â””â”€ ...
â”œâ”€ package.json
â”œâ”€ tsconfig.json
â””â”€ tslint.json
```

å€¼å¾—æ³¨æ„çš„æ˜¯

-   `tsconfig.json` åŒ…å«æˆ‘ä»¬é¡¹ç›®çš„ TypeScriptç‰¹å®šé€‰é¡¹. 
-   `tslint.json`å­˜å‚¨æˆ‘ä»¬çš„[TSLint](https://github.com/palantir/tslint)è®¾ç½®.
-   `package.json`åŒ…å«æˆ‘ä»¬çš„ä¾èµ–é¡¹,ä»¥åŠ æˆ‘ä»¬æƒ³è¦è¿è¡Œçš„å‘½ä»¤çš„ä¸€äº›å¿«æ·æ–¹å¼,ç”¨äº æµ‹è¯•,é¢„è§ˆå’Œéƒ¨ç½² æˆ‘ä»¬çš„åº”ç”¨ç¨‹åº. 
-   `public`åŒ…å«é™æ€èµ„äº§,ä¾‹å¦‚æˆ‘ä»¬è®¡åˆ’éƒ¨ç½²åˆ°çš„ HTMLé¡µé¢æˆ–å›¾åƒ. æ‚¨å¯ä»¥åˆ é™¤ æ­¤æ–‡ä»¶å¤¹ä¸­çš„ä»»ä½•æ–‡ä»¶ é™¤äº†`index.html`. 
-   `src`åŒ…å«æˆ‘ä»¬çš„ TypeScriptå’ŒCSSä»£ç . `index.tsx`æ˜¯æˆ‘ä»¬æ–‡ä»¶çš„å…¥å£ç‚¹,æ˜¯å¿…å¡«é¡¹. 

# è¿è¡Œé¡¹ç›®

è¿è¡Œé¡¹ç›®ä¸€æ ·ç®€å•

```sh
npm run start
```

è¿™è¿è¡Œ`start`,æ˜¯ä½äºæˆ‘ä»¬`package.json`çš„`script`å­—æ®µä¸­ ,å¹¶å°†åœ¨æˆ‘ä»¬ä¿å­˜æ–‡ä»¶æ—¶ é‡æ–°ç”Ÿæˆ ä¸ é‡æ–°åŠ è½½ é¡µé¢çš„æœåŠ¡å™¨. é€šå¸¸,æœåŠ¡å™¨è¿è¡Œäº`http://localhost:3000`,ä½†åº”è¯¥è‡ªåŠ¨ä¸ºæ‚¨æ‰“å¼€äº†. 

è¿™å…è®¸æˆ‘ä»¬å¿«é€Ÿé¢„è§ˆæ›´æ”¹,ä»è€Œ æ”¶ç´§è¿­ä»£å¾ªç¯. 

# æµ‹è¯•é¡¹ç›®

æµ‹è¯•ä¹Ÿåªæ˜¯ä¸€ä¸ªå‘½ä»¤: 

```sh
npm run test
```

æ­¤å‘½ä»¤é’ˆå¯¹æ‰©å±•å`.test.ts`è¦ä¹ˆ`.spec.ts`ç»“å°¾çš„æ‰€æœ‰æ–‡ä»¶è¿è¡Œ Jest,è¿™æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æµ‹è¯•å®ç”¨ç¨‹åº. åƒ`npm run start`å‘½ä»¤, Jestä¼šåœ¨æ£€æµ‹åˆ°æ›´æ”¹åç«‹å³è‡ªåŠ¨è¿è¡Œ. å¦‚æœä½ æ„¿æ„,ä½ å¯ä»¥è®©`npm run start`å’Œ`npm run test`å¹¶æ’è¿è¡Œ,ä»¥ä¾¿æ‚¨å¯ä»¥é¢„è§ˆæ›´æ”¹ å¹¶ åŒæ—¶æµ‹è¯•å®ƒä»¬. 

# åˆ›å»ºç”Ÿäº§æ„å»º

ç”¨`npm run start`è¿è¡Œé¡¹ç›®æ—¶,æˆ‘ä»¬æœ€ç»ˆæ²¡æœ‰å¾—åˆ°ä¼˜åŒ–çš„æ„å»º. é€šå¸¸,æˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬å‘é€ç»™ ç”¨æˆ·çš„ä»£ç  å°½å¯èƒ½å¿«é€Ÿå’Œå°å·§. ç¼©å° ç­‰.ä¸ºäº†å¯ä»¥å®ç°ä¼˜åŒ–è¿™ä¸€ç›®æ ‡,é€šå¸¸éœ€è¦æ›´å¤šæ—¶é—´. æˆ‘ä»¬ç§°ä¹‹ä¸º"ç”Ÿäº§"æ„å»ºçš„æ„å»º (ä¸å¼€å‘æ„å»ºç›¸å¯¹) . 

è¦è¿è¡Œç”Ÿäº§æ„å»º,åªéœ€è¿è¡Œå³å¯

```sh
npm run build
```

è¿™å°†åˆ›å»ºä¸€ä¸ª ä¼˜åŒ–çš„ JSå’ŒCSS åˆ†åˆ«æ„å»ºåœ¨`./build/static/js`å’Œ`./build/static/css`. 

æ‚¨ä¸éœ€è¦åœ¨å¤§å¤šæ•°æ—¶é—´è¿è¡Œç”Ÿäº§æ„å»º,ä½†å¦‚æœæ‚¨éœ€è¦æµ‹é‡åº”ç”¨ç¨‹åºçš„æœ€ç»ˆå¤§å°ç­‰å†…å®¹,åˆ™éå¸¸æœ‰ç”¨. 

# åˆ›å»ºç»„ä»¶

æˆ‘ä»¬è¦å†™ä¸€ä¸ª`Hello`ç»„ä»¶. è¯¥ç»„ä»¶å°†é‡‡ç”¨æˆ‘ä»¬æƒ³è¦ é—®å€™çš„åç§°å˜é‡ (æˆ‘ä»¬å°†ç§°ä¹‹ä¸º`name`) ,ä»¥åŠå¯é€‰çš„æ„Ÿå¹å·æ•°é‡ (`enthusiasmLevel`) . 

å½“æˆ‘ä»¬å†™ç±»ä¼¼`<Hello name="Daniel" enthusiasmLevel={3} />`,ç»„ä»¶åº”è¯¥å‘ˆç°ç±»ä¼¼çš„ä¸œè¥¿`<div>Hello Daniel!!!</div>`. å¦‚æœ`enthusiasmLevel`æœªæŒ‡å®š,ç»„ä»¶åº”é»˜è®¤æ˜¾ç¤ºä¸€ä¸ªæ„Ÿå¹å·. å¦‚æœ`enthusiasmLevel`æ˜¯`0`æˆ–è€…å¦å®š,å®ƒåº”è¯¥æŠ›å‡ºä¸€ä¸ªé”™è¯¯. 

æˆ‘ä»¬ä¼šå†™ä¸€ä¸ª`Hello.tsx`: 

```ts
// src/components/Hello.tsx

import * as React from 'react';

export interface Props {
  name: string;
  enthusiasmLevel?: number;
}

function Hello({ name, enthusiasmLevel = 1 }: Props) {
  if (enthusiasmLevel <= 0) {
    throw new Error('You could be a little more enthusiastic. :D');
  }

  return (
    <div className="hello">
      <div className="greeting">
        Hello {name + getExclamationMarks(enthusiasmLevel)}
      </div>
    </div>
  );
}

export default Hello;

// helpers

function getExclamationMarks(numChars: number) {
  return Array(numChars + 1).join('!');
}
```

è¯·æ³¨æ„,æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªåä¸º`Props`çš„ç±»å‹`interface`,å®ƒæŒ‡å®šäº†æˆ‘ä»¬çš„ç»„ä»¶å°†é‡‡ç”¨çš„å±æ€§. `name`æ˜¯å¿…éœ€çš„`string`,å’Œ`enthusiasmLevel`æ˜¯å¯é€‰çš„`number` (ä½ å¯ä»¥ä»ä¸­`?`å¾—çŸ¥,`enthusiasmLevel?: number;`). 

æˆ‘ä»¬ä¹Ÿå†™äº†`Hello`ä½œä¸ºæ— çŠ¶æ€åŠŸèƒ½ç»„ä»¶ (SFC) . å†å…·ä½“ä¸€ç‚¹,`Hello`æ˜¯ä¸€ä¸ªéœ€è¦`Props`å¯¹è±¡æ¥å£çš„å‡½æ•°,å¹¶å¯¹å…¶è¿›è¡Œè§£æ„. å¦‚æœ`enthusiasmLevel`æˆ‘ä»¬æ²¡æœ‰å€¼,å®ƒå°†é»˜è®¤ä¸º`1`. 

ç¼–å†™å‡½æ•°æ˜¯ä¸¤ä¸ªä¸»è¦[React å»ºç»„ä»¶çš„æ–¹å¼]((https://facebook.github.io/react/docs/components-and-props.html#functional-and-class-components)ä¹‹ä¸€. å¦‚æœæˆ‘ä»¬æƒ³è¦,æˆ‘ä»¬*å¯ä»¥*æŠŠå®ƒå†™æˆä¸€ä¸ªç±»å¦‚ä¸‹: 

```ts
class Hello extends React.Component<Props, object> {
  render() {
    const { name, enthusiasmLevel = 1 } = this.props;

    if (enthusiasmLevel <= 0) {
      throw new Error('You could be a little more enthusiastic. :D');
    }

    return (
      <div className="hello">
        <div className="greeting">
          Hello {name + getExclamationMarks(enthusiasmLevel)}
        </div>
      </div>
    );
  }
}
```

ç±»æ˜¯æœ‰ç”¨çš„[å½“ æˆ‘ä»¬ ç»„ä»¶å®ä¾‹  æœ‰ä¸€äº›çŠ¶æ€æ—¶ ](https://facebook.github.io/react/docs/state-and-lifecycle.html). ä½†æ˜¯åœ¨è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬å¹¶ä¸éœ€è¦è€ƒè™‘ çŠ¶æ€ - äº‹å®ä¸Š,æˆ‘ä»¬å°†å…¶æŒ‡å®šä¸º`object`åœ¨`React.Component<Props, object>`,å› æ­¤ ç¼–å†™SFC å¾€å¾€ä¼šæ›´çŸ­. åœ¨åˆ›å»º å¯ä»¥åœ¨åº“ä¹‹é—´ å…±äº«çš„é€šç”¨UIå…ƒç´  æ—¶,æœ¬åœ°ç»„ä»¶çŠ¶æ€ åœ¨ è¡¨ç¤ºç»„ä»¶çº§åˆ«ä¸Š æ›´æœ‰ç”¨. å¯¹äºæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸ,æˆ‘ä»¬å°† é‡æ–°å®¡è§†åº”ç”¨ç¨‹åº å¦‚ä½•ä½¿ç”¨Reduxç®¡ç† é€šç”¨çŠ¶æ€. 

ç°åœ¨æˆ‘ä»¬å·²ç»ç¼–å†™äº†æˆ‘ä»¬çš„ç»„ä»¶,è®©æˆ‘ä»¬æ·±å…¥ç ”ç©¶`index.tsx`å¹¶æ›¿æ¢æˆ‘ä»¬çš„æ¸²æŸ“`<App />`ä¸æ¸²æŸ“`<Hello ... />`. 

é¦–å…ˆ,æˆ‘ä»¬å°†å®ƒå¯¼å…¥æ–‡ä»¶çš„é¡¶éƒ¨: 

```ts
import Hello from './components/Hello';
```

ç„¶åæ”¹å˜æˆ‘ä»¬çš„`render`: 

```ts
ReactDOM.render(
  <Hello name="TypeScript" enthusiasmLevel={10} />,
  document.getElementById('root') as HTMLElement
);
```

## ç±»å‹æ–­è¨€

æˆ‘ä»¬åœ¨æœ¬èŠ‚ä¸­,éœ€è¦æŒ‡å‡ºçš„æœ€åä¸€ä»¶äº‹å°±æ˜¯è¿™æ¡`document.getElementById('root') as HTMLElement`. æ­¤è¯­æ³•ç§°ä¸ºä¸€ä¸ª*ç±»å‹æ–­è¨€*,æœ‰æ—¶ä¹Ÿç§°ä¸º*cast*. å½“ ä½  æ¯” ç±»å‹æ£€æŸ¥å™¨ æ›´æ¸…æ¥š ç±»å‹ æ—¶,è¿™æ˜¯å‘Šè¯‰ TypeScriptè¡¨è¾¾å¼çš„çœŸå®ç±»å‹çš„æœ‰ç”¨æ–¹æ³•. 

åœ¨è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦è¿™æ ·åšçš„åŸå› æ˜¯ `getElementById`çš„å›å½’ç±»å‹æ˜¯`HTMLElement | null`. ç®€å•åœ°è¯´,`getElementById`å›æŠ¥`null`,å½“å®ƒæ‰¾ä¸åˆ°ç»™å®šçš„`id`å…ƒç´ æ—¶. æˆ‘ä»¬å‡è®¾é‚£æ ·`getElementById`å®é™…ä¸Šä¼šæˆåŠŸ,æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨`as`è¯­æ³•æ¥è¯´æœTypeScript. 

TypeScriptè¿˜æœ‰ä¸€ä¸ªå°¾éš"bang"è¯­æ³• (`!`) ,ä»å‰é¢çš„è¡¨è¾¾å¼åˆ é™¤`null`å’Œ`undefined`. æ‰€ä»¥æˆ‘ä»¬*å¯ä»¥*å·²ç»å†™äº†`document.getElementById('root')!`,ä½†åœ¨è¿™ç§æƒ…å†µä¸‹,æˆ‘ä»¬æƒ³è¦æ›´æ˜ç¡®ä¸€ç‚¹. 

# æ·»åŠ style ğŸ˜

ä½¿ç”¨æˆ‘ä»¬çš„è®¾ç½®,æ·»åŠ ç»„ä»¶æ ·å¼å¾ˆç®€å•. å¯¹äºæˆ‘ä»¬çš„`Hello`ç»„ä»¶,æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªCSSæ–‡ä»¶`src/components/Hello.css`. 

```css
.hello {
  text-align: center;
  margin: 20px;
  font-size: 48px;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

.hello button {
  margin-left: 25px;
  margin-right: 25px;
  font-size: 40px;
  min-width: 50px;
}
```

create-react-app ä½¿ç”¨çš„å·¥å…· (å³Webpackå’Œå„ç§åŠ è½½å™¨) å…è®¸æˆ‘ä»¬åªå¯¼å…¥æˆ‘ä»¬æ„Ÿå…´è¶£çš„æ ·å¼è¡¨. å½“æˆ‘ä»¬çš„æ„å»ºè¿è¡Œæ—¶,ä»»ä½•å¯¼å…¥çš„`.css`æ–‡ä»¶ å°† è¿æ¥åˆ°è¾“å‡ºæ–‡ä»¶ä¸­. æ‰€ä»¥`src/components/Hello.tsx`,æˆ‘ä»¬å°†æ·»åŠ ä»¥ä¸‹å¯¼å…¥. 

```ts
import './Hello.css';
```

# ç”¨Jestå†™æµ‹è¯•

æˆ‘ä»¬æœ‰ä¸€äº›å…³äºæˆ‘ä»¬`Hello`ç»„ä»¶çš„å‡è®¾. è®©æˆ‘ä»¬é‡ç”³å®ƒä»¬æ˜¯ä»€ä¹ˆ: 


> -   å½“æˆ‘ä»¬å†™ç±»ä¼¼ç±»ä¼¼`<Hello name="Daniel" enthusiasmLevel={3} />`çš„ä¸œè¥¿,ç»„ä»¶åº”è¯¥å‘ˆç°`<div>Hello Daniel!!!</div>`

> -   å¦‚æœæœªæŒ‡å®š,ç»„ä»¶åº”é»˜è®¤æ˜¾ç¤ºä¸€ä¸ªæ„Ÿå¹å·. `enthusiasmLevel`

> -   å¦‚æœ`enthusiasmLevel`ä¸º `0`æˆ–è€…å¦å®š,å®ƒåº”è¯¥æŠ›å‡ºä¸€ä¸ªé”™è¯¯.

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›è¦æ±‚ä¸ºæˆ‘ä»¬çš„ç»„ä»¶ç¼–å†™ä¸€äº›æµ‹è¯•. 

ä½†é¦–å…ˆ,è®©æˆ‘ä»¬å®‰è£… Enzyme. [Enzyme](http://airbnb.io/enzyme/)æ˜¯Reactç”Ÿæ€ç³»ç»Ÿä¸­çš„å¸¸ç”¨å·¥å…·,å¯ä»¥æ›´è½»æ¾åœ°ç¼–å†™ ç»„ä»¶è¡Œä¸º æ–¹å¼çš„æµ‹è¯•. é»˜è®¤æƒ…å†µä¸‹,æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºåŒ…å«ä¸€ä¸ªåä¸º jsdom çš„åº“,å…è®¸æˆ‘ä»¬æ¨¡æ‹ŸDOM å¹¶åœ¨æ²¡æœ‰æµè§ˆå™¨çš„æƒ…å†µä¸‹ æµ‹è¯•å…¶è¿è¡Œæ—¶ è¡Œä¸º. 

Enzymeç±»ä¼¼,ä½†å»ºç«‹åœ¨jsdomä¸Š,å¯ä»¥æ›´å®¹æ˜“åœ°å¯¹æˆ‘ä»¬çš„ç»„ä»¶è¿›è¡ŒæŸäº›æŸ¥è¯¢. è®©æˆ‘ä»¬å°†å…¶ å®‰è£… ä¸º å¼€å‘ä¾èµ–é¡¹. 

```sh
npm install -D enzyme @types/enzyme enzyme-adapter-react-16 @types/enzyme-adapter-react-16 react-test-renderer
```

æ³¨æ„æˆ‘ä»¬å®‰è£…äº†åŒ…`enzyme`ä»¥åŠ`@types/enzyme`. è¯¥`enzyme`æŒ‡çš„æ˜¯åŒ…å«å®é™…è¿è¡Œçš„JavaScriptä»£ç çš„åŒ…,è€Œ`@types/enzyme`æ˜¯ä¸€ä¸ªåŒ…å«å£°æ˜æ–‡ä»¶(`.d.ts`æ–‡ä»¶)çš„åŒ… ä»¥ä¾¿ TypeScriptå¯ä»¥ç†è§£å¦‚ä½•ä½¿ç”¨Enzyme. æ‚¨å¯ä»¥äº†è§£æ›´å¤šä¿¡æ¯`@types`åŒ…[here](https://www.typescriptlang.org/docs/handbook/declaration-files/consumption.html). 

æˆ‘ä»¬è¿˜å¿…é¡»å®‰è£…`enzyme-adapter-react-16 and react-test-renderer`. è¿™æ˜¯äº‹æƒ…`enzyme`æœŸæœ›å®‰è£…. 

åœ¨ç¼–å†™ç¬¬ä¸€ä¸ªæµ‹è¯•ä¹‹å‰,æˆ‘ä»¬å¿…é¡»é…ç½® Enzymeä»¥ä½¿ç”¨React 16 çš„é€‚é…å™¨. æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªåä¸º `src/setupTests.ts`çš„æ–‡ä»¶, è¿™ä¼šåœ¨è¿è¡Œæµ‹è¯•æ—¶è‡ªåŠ¨åŠ è½½:

```ts
import * as enzyme from 'enzyme';
import * as Adapter from 'enzyme-adapter-react-16';

enzyme.configure({ adapter: new Adapter() });
```

ç°åœ¨æˆ‘ä»¬å·²ç»è®¾ç½®äº†Enzyme,è®©æˆ‘ä»¬å¼€å§‹ç¼–å†™æµ‹è¯•!
è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸º`src/components/Hello.test.tsx`çš„æ–‡ä»¶,æ¯—é‚»æˆ‘ä»¬æ—©å…ˆçš„`Hello.tsx`æ–‡ä»¶. 

```ts
// src/components/Hello.test.tsx

import * as React from 'react';
import * as enzyme from 'enzyme';
import Hello from './Hello';

it('renders the correct text when no enthusiasm level is given', () => {
  const hello = enzyme.shallow(<Hello name='Daniel' />);
  expect(hello.find(".greeting").text()).toEqual('Hello Daniel!')
});

it('renders the correct text with an explicit enthusiasm of 1', () => {
  const hello = enzyme.shallow(<Hello name='Daniel' enthusiasmLevel={1}/>);
  expect(hello.find(".greeting").text()).toEqual('Hello Daniel!')
});

it('renders the correct text with an explicit enthusiasm level of 5', () => {
  const hello = enzyme.shallow(<Hello name='Daniel' enthusiasmLevel={5} />);
  expect(hello.find(".greeting").text()).toEqual('Hello Daniel!!!!!');
});

it('throws when the enthusiasm level is 0', () => {
  expect(() => {
    enzyme.shallow(<Hello name='Daniel' enthusiasmLevel={0} />);
  }).toThrow();
});

it('throws when the enthusiasm level is negative', () => {
  expect(() => {
    enzyme.shallow(<Hello name='Daniel' enthusiasmLevel={-1} />);
  }).toThrow();
});
```

è¿™äº›æµ‹è¯•éå¸¸åŸºç¡€,ä½†ä½ åº”è¯¥èƒ½å¤ŸæŒæ¡ä¸€åˆ‡. 

# æ·»åŠ çŠ¶æ€ç®¡ç†

æ­¤æ—¶,å¦‚æœæ‚¨ä½¿ç”¨React,èƒ½è·å–ä¸€æ¬¡æ•°æ®å¹¶æ˜¾ç¤ºå®ƒ,æ‚¨å¯ä»¥è®¤ä¸ºè‡ªå·±å®Œæˆäº†. 

ä½†æ˜¯,å¦‚æœæ‚¨æ­£åœ¨å¼€å‘ä¸€ä¸ªæ›´å…·äº¤äº’æ€§çš„åº”ç”¨ç¨‹åº,é‚£ä¹ˆæ‚¨å¯èƒ½éœ€è¦æ·»åŠ  çŠ¶æ€ç®¡ç†. 

## é€šç”¨çŠ¶æ€ç®¡ç†

Reactæœ¬èº«å°±æ˜¯ä¸€ä¸ªç”¨äºåˆ›å»º å¯ç»„åˆè§†å›¾ çš„æœ‰ç”¨åº“. 

ä½†æ˜¯,React æ²¡æœ‰ä»»ä½•ç”¨äº åœ¨æ‚¨çš„åº”ç”¨ç¨‹åºä¹‹é—´ åŒæ­¥æ•°æ®çš„å·¥å…·. å°±Reactç»„ä»¶è€Œè¨€,æ•°æ®é€šè¿‡æ‚¨åœ¨å­å…ƒç´ ä¸ŠæŒ‡å®šçš„ props å‘ä¸‹æµåŠ¨. 

ç”±äºReactæœ¬èº«ä¸æä¾›å¯¹ çŠ¶æ€ç®¡ç†çš„ å†…ç½®æ”¯æŒ,å› æ­¤Reactç¤¾åŒºä½¿ç”¨ Reduxå’ŒMobX ç­‰åº“. 
 

[Redux](http://redux.js.org)ä¾èµ–äºé€šè¿‡ é›†ä¸­ä¸”ä¸å¯å˜çš„æ•°æ®å­˜å‚¨ æ¥ åŒæ­¥æ•°æ®,å¯¹è¯¥æ•°æ®çš„æ›´æ–° å°† è§¦å‘ æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçš„ é‡æ–°å‘ˆç°.é€šè¿‡å‘é€ç”±ç§°ä¸ºreducers çš„ å‡½æ•°å¤„ç† çš„ æ˜¾å¼æ“ä½œæ¶ˆæ¯,ä»¥ ä¸å¯å˜çš„æ–¹å¼ æ›´æ–°çŠ¶æ€. ç”±äºå…·æœ‰æ˜ç¡®çš„æ€§è´¨,é€šå¸¸æ›´å®¹æ˜“æ¨ æ–­æŸä¸ªæ“ä½œ å°† å¦‚ä½•å½±å“æ‚¨çš„ç¨‹åºçŠ¶æ€. 



[MobX](https://mobx.js.org/)ä¾èµ–äºå‡½æ•°ååº”æ¨¡å¼,å…¶ä¸­ çŠ¶æ€é€šè¿‡ å¯è§‚å¯ŸåŒ…è£… å’Œ ä½œä¸º props ä¼ é€’. é€šè¿‡ç®€å•åœ°å°† çŠ¶æ€æ ‡è®°ä¸ºå¯è§‚å¯ŸçŠ¶æ€ æ¥ä¿æŒ çŠ¶æ€å®Œå…¨åŒæ­¥ ä»¥ ç”¨äºä»»ä½•è§‚å¯Ÿè€…. æ›´å¥½çš„æ˜¯,è¯¥åº“å·²ç»ç”¨ TypeScriptç¼–å†™. ä¸¤è€…éƒ½æœ‰å„ç§ä¼˜ç‚¹å’Œæƒè¡¡. 

é€šå¸¸Redux å€¾å‘äºçœ‹åˆ°æ›´å¹¿æ³›çš„ç”¨æ³•,å› æ­¤ä¸ºäº†æœ¬æ•™ç¨‹çš„ç›®çš„,æˆ‘ä»¬å°†ä¸“æ³¨äºæ·»åŠ Redux;ä½†æ˜¯,ä½ åº”è¯¥æ„Ÿåˆ°é¼“åŠ±å»æ¢ç´¢ä¸¤è€…. 

ä»¥ä¸‹éƒ¨åˆ†å¯èƒ½æœ‰ä¸€ä¸ªé™¡å³­çš„å­¦ä¹ æ›²çº¿. æˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½ [é€šè¿‡å…¶æ–‡æ¡£ç†Ÿæ‚‰Redux](http://redux.js.org/)

## ä¸º actions è®¾å®šé˜¶æ®µ

é™¤éæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçŠ¶æ€å‘ç”Ÿå˜åŒ–,å¦åˆ™ æ·»åŠ Redux æ˜¯æ²¡æœ‰æ„ä¹‰çš„. 

æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¯ä»¥è§¦å‘æ›´æ”¹çš„æ“ä½œæº. 

è¿™å¯ä»¥æ˜¯è®¡æ—¶å™¨,ä¹Ÿå¯ä»¥æ˜¯U Iä¸­çš„æŸä¸ªæŒ‰é’®. ä¸ºäº†æˆ‘ä»¬çš„ç›®çš„,æˆ‘ä»¬å°†æ·»åŠ ä¸¤ä¸ªæŒ‰é’®æ¥æ§åˆ¶æˆ‘ä»¬`Hello`ç»„ä»¶çš„çƒ­æƒ…ç¨‹åº¦. 

## å®‰è£…Redux

è¦æ·»åŠ Redux,æˆ‘ä»¬å°†é¦–å…ˆå®‰è£…`redux`å’Œ`react-redux`,ä»¥åŠå®ƒä»¬çš„ç±»å‹,ä½œä¸ºä¾èµ–. 

```sh
npm install -S redux react-redux @types/react-redux
```

åœ¨è¿™ç§æƒ…å†µä¸‹,æˆ‘ä»¬ä¸éœ€è¦å®‰è£…`@types/redux`å› ä¸ºReduxå·²ç»é™„å¸¦äº†è‡ªå·±çš„å®šä¹‰æ–‡ä»¶ (`.d.ts`æ–‡ä»¶) . 

## ç®€å•è¯´æ˜ Redux æµç¨‹

### Redux æœ¬èº«éœ€è¦è®¾ç½®çš„

1. è¦æœ‰ åŸºç¡€çŠ¶æ€çš„å­˜å‚¨ - [`Store`](#%E5%AE%9A%E4%B9%89%E6%88%91%E4%BB%AC%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%9A%84%E7%8A%B6%E6%80%81)

2. è¦æœ‰ å¯¹åº”æ›´æ”¹å­˜å‚¨çš„ æ“ä½œå/ç±»å‹ - [`actions`](#%E6%B7%BB%E5%8A%A0action)

3. è€Œ è¿‡æ»¤ `ä¸åŒæ“ä½œ-actions.type`å, è¿”å› å¯¹åº”æ›´æ”¹çŠ¶æ€ - [`reducer`](#%E6%B7%BB%E5%8A%A0-%E5%87%8F%E9%80%9F%E6%9C%BA-reducer)

4. ä¸ºäº† é—­åˆ çŠ¶æ€ç®¡ç†çš„å›è·¯, çŠ¶æ€æœ‰äº†, æ“ä½œæœ‰äº†, æ€ä¹ˆæ›´æ”¹æœ‰äº†, å°±æ˜¯ç¼ºäº† è§¦å‘ - `dispatch` ç”±Reduxæœ¬èº«æä¾›

5. ç»„åˆRedux æ‰€æœ‰å®šä¹‰çš„- [createStore](#%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8)

### è®¾ç½®å¥½Reduxå,ä¸ç»„ä»¶æ··åˆæˆä¸ºå®¹å™¨

1. ä¸ºäº† ç»„ä»¶çš„çŠ¶æ€ ä¸ Redux çš„çŠ¶æ€ è”ç³»èµ·æ¥æœ‰ [`mapStateToProps`](#%E5%88%B6%E4%BD%9C%E4%B8%80%E4%B8%AA%E5%AE%B9%E5%99%A8)

2. ä¸ºäº† ç»„ä»¶ä¸Redux çš„ `è§¦å‘æ“ä½œ-dispatch` è”ç³»æœ‰ [`mapDispatchToProps`](#%E5%88%B6%E4%BD%9C%E4%B8%80%E4%B8%AA%E5%AE%B9%E5%99%A8)

3. ä¸Šé¢ä¸¤ç§æ˜¯é…ç½®å®šä¹‰, è€Œ æ··åˆçš„è¿è¡Œ äº¤ç”± [`connect`](#%E5%88%B6%E4%BD%9C%E4%B8%80%E4%B8%AA%E5%AE%B9%E5%99%A8)

4. æœ€å, æŠŠ æ•´ä¸ª store æ‰”è¿› React æ¸²æŸ“æµç¨‹ - [Provider](#%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8)

## å®šä¹‰æˆ‘ä»¬åº”ç”¨ç¨‹åºçš„çŠ¶æ€

æˆ‘ä»¬éœ€è¦å®šä¹‰ Redux å°†å­˜å‚¨çš„ çŠ¶æ€å½¢çŠ¶. ä¸ºæ­¤,æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªåä¸º`src/types/index.tsx`çš„æ–‡ä»¶,å®ƒå°†åŒ…å«æˆ‘ä»¬ å¯èƒ½åœ¨æ•´ä¸ªç¨‹åºä¸­ ä½¿ç”¨çš„ ç±»å‹å®šä¹‰. 

```ts
// src/types/index.tsx

export interface StoreState {
    languageName: string;
    enthusiasmLevel: number;
}
```

è¯´æ˜: `languageName`å°†æ˜¯è¿™ä¸ªåº”ç”¨ç¨‹åºç¼–å†™çš„ç¼–ç¨‹è¯­è¨€ (å³ TypeScriptæˆ–JavaScript) å’Œ`enthusiasmLevel`ä¼šæœ‰æ‰€ä¸åŒ. å½“æˆ‘ä»¬ç¼–å†™ç¬¬ä¸€ä¸ªå®¹å™¨æ—¶,æˆ‘ä»¬ä¼šç†è§£,ä¸ºä»€ä¹ˆæˆ‘ä»¬æ•…æ„ä½¿ æˆ‘ä»¬çš„çŠ¶æ€ä¸æˆ‘ä»¬çš„ props ç•¥æœ‰ä¸åŒ. 

## æ·»åŠ action

è®©æˆ‘ä»¬ä»åˆ›å»ºä¸€ç»„æˆ‘ä»¬çš„åº”ç”¨å¯ä»¥å“åº”çš„æ¶ˆæ¯ç±»å‹å¼€å§‹`src/constants/index.tsx`. 

```ts
// src/constants/index.tsx

export const INCREMENT_ENTHUSIASM = 'INCREMENT_ENTHUSIASM';
export type INCREMENT_ENTHUSIASM = typeof INCREMENT_ENTHUSIASM;


export const DECREMENT_ENTHUSIASM = 'DECREMENT_ENTHUSIASM';
export type DECREMENT_ENTHUSIASM = typeof DECREMENT_ENTHUSIASM;
```

è¿™ä¸ª`const`/`type`é»˜è®¤å…è®¸æˆ‘ä»¬,ä»¥ æ˜“äºè®¿é—®å’Œå¯é‡æ„çš„æ–¹å¼ ä½¿ç”¨TypeScriptçš„å­—ç¬¦ä¸²æ–‡å­—ç±»å‹. 

æ¥ä¸‹æ¥,æˆ‘ä»¬å°†åˆ›å»ºä¸€ç»„ actions å’ŒåŠŸèƒ½,å¯ä»¥åœ¨å…¶ä¸­åˆ›å»ºè¿™äº› actions. `src/actions/index.tsx`. 

```ts
import * as constants from '../constants'

export interface IncrementEnthusiasm {
    type: constants.INCREMENT_ENTHUSIASM;
}

export interface DecrementEnthusiasm {
    type: constants.DECREMENT_ENTHUSIASM;
}

export type EnthusiasmAction = IncrementEnthusiasm | DecrementEnthusiasm;

export function incrementEnthusiasm(): IncrementEnthusiasm {
    return {
        type: constants.INCREMENT_ENTHUSIASM
    }
}

export function decrementEnthusiasm(): DecrementEnthusiasm {
    return {
        type: constants.DECREMENT_ENTHUSIASM
    }
}
```

æˆ‘ä»¬åˆ›å»ºäº†ä¸¤ç§ç±»å‹æ¥æè¿°*å¢é‡*å’Œ*å‡é‡*`actions-æ“ä½œ`åº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­. æˆ‘ä»¬è¿˜åˆ›å»ºäº†ä¸€ä¸ªç±»å‹ (`EnthusiasmAction`) æè¿°ä¸€ä¸ª action å¯ä»¥æ˜¯å¢é‡æˆ–å‡é‡çš„æƒ…å†µ. æœ€å,æˆ‘ä»¬åˆ¶ä½œäº†ä¸¤ä¸ªå‡½æ•°,æ¥å®é™…åˆ¶ä½œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨çš„ action ,è€Œä¸æ˜¯å†™å‡ºåºå¤§çš„å¯¹è±¡æ–‡å­—. 

è¿™é‡Œæœ‰æ˜æ˜¾çš„æ ·æ¿,æ‰€ä»¥ä½ åº”è¯¥éšæ„æŸ¥çœ‹ç±»ä¼¼[redux-actions](https://www.npmjs.com/package/redux-actions),ä¸€æ—¦ä½ æŒæ¡äº†ä¸€åˆ‡. 

## æ·»åŠ  å‡é€Ÿæœº-reducer

æˆ‘ä»¬å‡†å¤‡å¥½å†™ç¬¬ä¸€å°å‡é€Ÿæœºäº†! Reducers **è¿‡æ»¤** åˆ›å»ºåº”ç”¨ç¨‹åºçŠ¶æ€ æ¥ ç”Ÿæˆå¯¹åº”çš„æ›´æ”¹çŠ¶æ€,ä½†å´æ˜¯*æ— å‰¯ä½œç”¨*. æ¢å¥è¯è¯´,ä»–ä»¬å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„*[çº¯å‡½æ•°](https://en.wikipedia.org/wiki/Pure_function)*. 

æˆ‘ä»¬çš„å‡é€Ÿæœºå°†è¿›å…¥`src/reducers/index.tsx`. å®ƒçš„å‡½æ•°æ˜¯ç¡®ä¿ å¢é‡ å°† çƒ­æƒ…æ°´å¹³ æé«˜1,è€Œ å‡é‡ å°† çƒ­æƒ…æ°´å¹³ é™ä½1,ä½†çƒ­æƒ…ä»ä¸ä½äº1. 

```ts
// src/reducers/index.tsx

import { EnthusiasmAction } from '../actions';
import { StoreState } from '../types/index';
import { INCREMENT_ENTHUSIASM, DECREMENT_ENTHUSIASM } from '../constants/index';

export function enthusiasm(state: StoreState, action: EnthusiasmAction): StoreState {
  switch (action.type) { // é€‰æ‹© æˆ–è€…è¯´ è¿‡æ»¤
    case INCREMENT_ENTHUSIASM:
      return { ...state, enthusiasmLevel: state.enthusiasmLevel + 1 };
    case DECREMENT_ENTHUSIASM:
      return { ...state, enthusiasmLevel: Math.max(1, state.enthusiasmLevel - 1) };
  }
  return state;
}
```

è¯·æ³¨æ„,æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨*å¯¹è±¡ä¼ æ’­* (`...state`) å®ƒå…è®¸æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæµ…å±‚çš„çŠ¶æ€,åŒæ—¶æ›¿æ¢`enthusiasmLevel`. è¦æ³¨æ„çš„æ˜¯`enthusiasmLevel`å±æ€§æ˜¯æœ€åçš„,å› ä¸ºå¦åˆ™å®ƒå°†è¢«æˆ‘ä»¬æ—§çš„å±æ€§æ‰€è¦†ç›–. 

æ‚¨å¯èƒ½æƒ³ä¸ºå‡é€Ÿå™¨ç¼–å†™ä¸€äº›æµ‹è¯•. ç”±äº reducer æ˜¯çº¯å‡½æ•°,å› æ­¤å¯ä»¥ä¼ é€’ ä»»æ„æ•°æ®. å¯¹äºæ¯ä¸ªè¾“å…¥,å¯ä»¥é€šè¿‡æ£€æŸ¥ å…¶æ–°ç”Ÿæˆçš„çŠ¶æ€ æ¥æµ‹è¯•å‡é€Ÿå™¨. è€ƒè™‘ä¸€ä¸‹Jestçš„[toEqual](https://facebook.github.io/jest/docs/expect.html#toequalvalue)æ–¹æ³•,å»å®ç°è¿™ä¸€ç›®æ ‡. 

## åˆ¶ä½œä¸€ä¸ªå®¹å™¨

ä½¿ç”¨ Reduxç¼–å†™æ—¶,æˆ‘ä»¬ç»å¸¸ä¼šç¼–å†™ ç»„ä»¶å’Œå®¹å™¨. ç»„ä»¶é€šå¸¸ä¸æ•°æ®æ— å…³,å¹¶ä¸”ä¸»è¦åœ¨ è¡¨ç¤ºçº§åˆ« å·¥ä½œ. *å®¹å™¨*é€šå¸¸åŒ…è£…ç»„ä»¶å¹¶å‘å…¶æä¾› æ˜¾ç¤ºå’Œä¿®æ”¹çŠ¶æ€ æ‰€éœ€çš„ä»»ä½•æ•°æ®. æ‚¨å¯ä»¥é˜…è¯»æœ‰å…³æ­¤æ¦‚å¿µçš„æ›´å¤šä¿¡æ¯[Dan Abramov's æ–‡ç« *æ¼”ç¤ºå’Œå®¹å™¨ç»„ä»¶*](https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0). 

é¦–å…ˆè®©æˆ‘ä»¬æ›´æ–°`src/components/Hello.tsx`è¿™æ ·å®ƒå°±å¯ä»¥ä¿®æ”¹çŠ¶æ€. æˆ‘ä»¬`Props`å°†æ·»åŠ ä¸¤ä¸ªå¯é€‰çš„å›è°ƒå±æ€§å‘½å`onIncrement`å’Œ`onDecrement`: 

```ts
export interface Props {
  name: string;
  enthusiasmLevel?: number;
  onIncrement?: () => void;
  onDecrement?: () => void;
}
```

ç„¶åæˆ‘ä»¬å°†è¿™äº›å›è°ƒ,ç»‘å®š ä¸¤ä¸ª æˆ‘ä»¬å°†æ·»åŠ åˆ°ç»„ä»¶ä¸­ çš„ æ–°æŒ‰é’®. 

```ts
function Hello({ name, enthusiasmLevel = 1, onIncrement, onDecrement }: Props) {
  if (enthusiasmLevel <= 0) {
    throw new Error('You could be a little more enthusiastic. :D');
  }

  return (
    <div className="hello">
      <div className="greeting">
        Hello {name + getExclamationMarks(enthusiasmLevel)}
      </div>
      <div>
        <button onClick={onDecrement}>-</button>
        <button onClick={onIncrement}>+</button>
      </div>
    </div>
  );
}
```

ä¸€èˆ¬æ¥è¯´,ä¸º`onIncrement`å’Œ`onDecrement`ç¼–å†™ä¸€äº›è§¦å‘æµ‹è¯•,æ˜¯ä¸ªå¥½ä¸»æ„æ¯”å¦‚ å•å‡»å„è‡ªæŒ‰é’®. è¯•ä¸€è¯•ä¸ºæ‚¨çš„ç»„ä»¶ç¼–å†™æµ‹è¯•. 

ç°åœ¨æˆ‘ä»¬çš„ç»„ä»¶å·²æ›´æ–°,æˆ‘ä»¬å·²å‡†å¤‡å¥½å°† å…¶ åŒ…è£…åˆ°å®¹å™¨ä¸­. è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª`src/containers/Hello.tsx`,å¹¶ä»ä»¥ä¸‹å¯¼å…¥å¼€å§‹. 

```ts
import Hello from '../components/Hello';
import * as actions from '../actions/';
import { StoreState } from '../types/index';
import { connect, Dispatch } from 'react-redux';
```

è¿™é‡ŒçœŸæ­£çš„ä¸¤ä¸ªå…³é”®éƒ¨åˆ†æ˜¯,åŸ`Hello`ç»„ä»¶ä»¥åŠ`connect`å‡½æ•°æ¥è‡ªreact-redux. `connect`å°†èƒ½å¤ŸçœŸæ­£è½¬æ¢ æˆ‘ä»¬çš„åŸ`Hello`ç»„ä»¶ ä¸º èƒ½ä½¿ç”¨ä¸¤ä¸ªå‡½æ•°çš„å®¹å™¨: 

-   `mapStateToProps`å®ƒå°†æ¥è‡ªå½“å‰å­˜å‚¨çš„æ•°æ®,æŒ‰æ‘©åˆ°æˆ‘ä»¬ç»„ä»¶éƒ¨åˆ†æ‰€éœ€çš„å½¢çŠ¶. 
-   `mapDispatchToProps`å®ƒåˆ›å»ºå›è°ƒ,å°† ç»™å®šçš„action å’Œ è§¦å‘å­˜å‚¨çš„`dispatch`å‡½æ•°ç»“åˆ,ä½¿å¾—æ­£å¸¸ä½¿ç”¨ action åŒæ—¶èƒ½ `dispath`å­˜å‚¨. 

å¦‚æœæˆ‘ä»¬è®°å¾—,æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçŠ¶æ€åŒ…å«ä¸¤ä¸ªå±æ€§: `languageName`å’Œ`enthusiasmLevel`. å¦ä¸€æ–¹é¢æˆ‘ä»¬çš„`Hello`ç»„ä»¶é¢„æœŸä¸€ä¸ª`name`å’Œ`enthusiasmLevel`. `mapStateToProps`å°†ä»å­˜å‚¨ è·å– ç›¸å…³æ•°æ®,å¹¶åœ¨å¿…è¦æ—¶å¯¹ æˆ‘ä»¬ç»„ä»¶çš„ props è¿›è¡Œè°ƒæ•´. è®©æˆ‘ä»¬ç»§ç»­å†™ä¸‹æ¥å§. 

```ts
export function mapStateToProps({ enthusiasmLevel, languageName }: StoreState) {
  return {
    enthusiasmLevel,
    name: languageName,
  }
}
```

æ³¨æ„`mapStateToProps`ä»…åˆ›å»º4ä¸ªå±æ€§ä¸­çš„2ä¸ªç»™äº†`Hello`ç»„ä»¶æœŸæœ›. ä¹Ÿå°±æ˜¯è¯´,æˆ‘ä»¬ä»ç„¶å¸Œæœ›ä¼ å…¥`onIncrement`å’Œ`onDecrement`. 

> ä½† `onIncrement`å’Œ`onDecrement` æ˜¯ è§¦å‘ Redux å­˜å‚¨æ›´æ”¹çš„ å‡½æ•°, å¾€ä¸‹çœ‹

`mapDispatchToProps`æ˜¯ä¸€ä¸ªé‡‡ç”¨ dispatcher-è°ƒåº¦ç¨‹åº åŠŸèƒ½çš„å‡½æ•°. æ­¤è°ƒåº¦ç¨‹åºåŠŸèƒ½ å¯ä»¥å°† action ä¼ é€’åˆ°æˆ‘ä»¬çš„å­˜å‚¨ä»¥è¿›è¡Œæ›´æ–°,å› æ­¤ æˆ‘ä»¬æŠŠ dispatch ä¸ ä¸¤ä¸ª`on***` å‡½æ•°è”ç³»èµ·æ¥

```ts
export function mapDispatchToProps(dispatch: Dispatch<actions.EnthusiasmAction>) {
  return {
    onIncrement: () => dispatch(actions.incrementEnthusiasm()),
    onDecrement: () => dispatch(actions.decrementEnthusiasm()),
  }
}
```

æœ€å,æˆ‘ä»¬å‡†å¤‡å¥½äº†`connect`. `connect`å°†é¦–å…ˆé‡‡å–`mapStateToProps`å’Œ`mapDispatchToProps`,ç„¶åè¿”å›å¦ä¸€ä¸ªæˆ‘ä»¬å¯ä»¥ç”¨æ¥ åŒ…è£…æˆ‘ä»¬çš„ç»„ä»¶ çš„å‡½æ•°. æˆ‘ä»¬ç”Ÿæˆçš„å®¹å™¨ä½¿ç”¨ä»¥ä¸‹ä»£ç å®šä¹‰: 

```ts
export default connect(mapStateToProps, mapDispatchToProps)(Hello);
```

å®Œæˆå,æˆ‘ä»¬çš„æ–‡ä»¶åº”å¦‚ä¸‹æ‰€ç¤º: 

```ts
// src/containers/Hello.tsx

import Hello from '../components/Hello';
import * as actions from '../actions/';
import { StoreState } from '../types/index';
import { connect, Dispatch } from 'react-redux';

export function mapStateToProps({ enthusiasmLevel, languageName }: StoreState) {
  return {
    enthusiasmLevel,
    name: languageName,
  }
}

export function mapDispatchToProps(dispatch: Dispatch<actions.EnthusiasmAction>) {
  return {
    onIncrement: () => dispatch(actions.incrementEnthusiasm()),
    onDecrement: () => dispatch(actions.decrementEnthusiasm()),
  }
}

export default connect(mapStateToProps, mapDispatchToProps)(Hello);
```

## åˆ›å»ºå­˜å‚¨

æˆ‘ä»¬å›å»å§`src/index.tsx`. è¦æŠŠè¿™äº›æ”¾åœ¨ä¸€èµ·,æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªå…·æœ‰åˆå§‹çŠ¶æ€çš„å­˜å‚¨,å¹¶ä½¿ç”¨æˆ‘ä»¬æ‰€æœ‰çš„reducer è¿›è¡Œè®¾ç½®. 

```ts
import { createStore } from 'redux';
import { enthusiasm } from './reducers/index';
import { StoreState } from './types/index';

const store = createStore<StoreState>(enthusiasm, {
  enthusiasmLevel: 1,
  languageName: 'TypeScript',
});
```

æ­£å¦‚æ‚¨å¯èƒ½å·²ç»çŒœåˆ°çš„é‚£æ ·,`store`å°±æ˜¯,æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçš„å…¨çƒçŠ¶æ€çš„ä¸­å¤®å­˜å‚¨. 

æ¥ä¸‹æ¥,æˆ‘ä»¬å°†æŠŠ`./src/components/Hello`å˜æˆ`./src/containers/Hello`,å¹¶ä½¿ç”¨ react-redux'çš„`Provider`ç”¨ æˆ‘ä»¬çš„å®¹å™¨ è¿æ¥æˆ‘ä»¬çš„ props . å¯¼å…¥: 

```ts
import Hello from './containers/Hello';
import { Provider } from 'react-redux';
```

å¹¶é€šè¿‡æˆ‘ä»¬çš„`store`é€šè¿‡`Provider`çš„å±æ€§: 

```ts
ReactDOM.render(
  <Provider store={store}>
    <Hello />
  </Provider>,
  document.getElementById('root') as HTMLElement
);
```

è¯·æ³¨æ„`Hello`ä¸å†éœ€è¦ *props* ,å› ä¸ºæˆ‘ä»¬ä½¿ç”¨äº†`connect`å‡½æ•°,ä½¿æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçš„çŠ¶æ€,æ¥é€‚åº”æˆ‘ä»¬åŒ…è£…çš„`Hello`ç»„ä»¶çš„ props . 

# å¼¹å‡º-Ejecting

å¦‚æœåœ¨ä»»ä½•æ—¶å€™,æ‚¨è§‰å¾— æŸäº›è‡ªå®šä¹‰è®¾ç½® ä½¿ åˆ›å»º Reactåº”ç”¨ç¨‹åº å˜å¾—å›°éš¾,æ‚¨å¯ä»¥éšæ—¶é€‰æ‹©é€€å‡º,å¹¶è·å–æ‰€éœ€çš„å„ç§é…ç½®é€‰é¡¹. ä¾‹å¦‚,å¦‚æœæ‚¨æƒ³æ·»åŠ  Webpackæ’ä»¶,å¯èƒ½éœ€è¦åˆ©ç”¨ create-react-app æä¾›çš„"Ejecting"åŠŸèƒ½. 

ç®€å•åœ°

```sh
npm run eject
```

ä½ åº”è¯¥å¥½å¥½æ³¨æ„æ³¨æ„!

ä¸€å¼€å§‹,æ‚¨å¯èƒ½å¸Œæœ›åœ¨è¿è¡Œå¼¹å‡ºä¹‹å‰,æäº¤æ‰€æœ‰å·¥ä½œ. æ‚¨æ— æ³•æ’¤æ¶ˆå¼¹å‡ºå‘½ä»¤,å› æ­¤é€‰æ‹©é€€å‡ºæ˜¯æ°¸ä¹…æ€§çš„,é™¤éæ‚¨å¯ä»¥åœ¨è¿è¡Œå¼¹å‡ºä¹‹å‰,ä»æäº¤ä¸­æ¢å¤. 

# ä¸‹ä¸€æ­¥

create-react-app é™„å¸¦äº†å¾ˆå¤šå¾ˆæ£’çš„ä¸œè¥¿. å…¶ä¸­å¤§éƒ¨åˆ†éƒ½è®°å½•åœ¨é¡¹ç›®çš„`README.md`,æ‰€ä»¥è¯·å¿«é€Ÿé˜…è¯». 

å¦‚æœæ‚¨ä»æƒ³äº†è§£æœ‰å…³Reduxçš„æ›´å¤šä¿¡æ¯,æ‚¨å¯ä»¥[Reduxå®˜æ–¹ç½‘å€](http://redux.js.org/)ç”¨äºæ–‡æ¡£. åŒæ ·çš„é“ç†[MobXå®˜æ–¹ç½‘å€](https://mobx.js.org/). 

å¦‚æœä½ æƒ³åœ¨æŸäº›æ—¶å€™å¼¹å‡º,ä½ å¯èƒ½éœ€è¦æ›´å¤šåœ°äº†è§£ Webpack. ä½ å¯ä»¥çœ‹çœ‹æˆ‘ä»¬çš„[React & Webpack æºæ‰‹åˆå¥](https://www.typescriptlang.org/docs/handbook/react-&-webpack.html). 

åœ¨æŸäº›æ—¶å€™,æ‚¨å¯èƒ½éœ€è¦`è·¯ç”±-router`. æœ‰å‡ ç§è§£å†³æ–¹æ¡ˆ,ä½†æ˜¯[react-router](https://github.com/ReactTraining/react-router)å¯èƒ½æ˜¯ Reduxé¡¹ç›®ä¸­ æœ€å—æ¬¢è¿çš„,å¹¶ä¸”ç»å¸¸ä¸[react-router-redux](https://github.com/reactjs/react-router-redux)ç»“åˆä½¿ç”¨. 
